# 实验报告三

1. 实验环境
   - ubuntu 20.04.2
   - Virtual Box 6.1

2. 实验要求：
   - 阅读阮一峰的「Systemd 入门教程：命令篇」与「Systemd 入门教程：实战篇」并进行动手实操。录屏上传到asciinema
   - 完成课后自查清单

## 实验过程

### 动手实战Systemd

#### Systemd入门教程：命令篇

1. 由来
    [![asciicast](https://asciinema.org/a/405334.svg)](https://asciinema.org/a/405334)
2. Systemd 概述
   [![asciicast](https://asciinema.org/a/405336.svg)](https://asciinema.org/a/405336)
3. 系统管理
   [![asciicast](https://asciinema.org/a/405337.svg)](https://asciinema.org/a/405337)
4. Unit
   [![asciicast](https://asciinema.org/a/405340.svg)](https://asciinema.org/a/405340)
5. Unit 的配置文件
   [![asciicast](https://asciinema.org/a/406316.svg)](https://asciinema.org/a/406316)
6. Target
   [![asciicast](https://asciinema.org/a/406317.svg)](https://asciinema.org/a/406317)
7. 日志管理
   [![asciicast](https://asciinema.org/a/406318.svg)](https://asciinema.org/a/406318)

### Systemd 入门教程：实战篇
[![asciicast](https://asciinema.org/a/406320.svg)](https://asciinema.org/a/406320)

### 自查清单
1. 如何添加一个用户并使其具备sudo执行程序的权限？
      ```linux
    sudo adduser username  
    sudo usermod -G sudo -a username
    ```
2. 如何将一个用户添加到一个用户组？
     - usermod -a -G groupname username
3. 如何查看当前系统的分区表和文件系统详细信息？
   - df -hT 只可以查看已经挂载的分区和文件系统类型。
   - fdisk -l 可以显示出所有挂载和未挂载的分区，但不显示文件系统类型。
   - gdisk -l 同样可以显示出所有挂载和未挂载的分区，但不显示文件系统类型。
   - parted -l 可以查看未挂载的文件系统类型，以及哪些分区尚未格式化。大于2TB分区支持使用此
   - lsblk -f 也可以查看未挂载的文件系统类型
4. 如何实现开机自动挂载Virtualbox的共享目录分区？
   -  创建一个共享文件夹的挂载目录：`mkdir /mnt/share`
   - 用以下命令实现挂载：`mount-t vboxsf share_file_name /mnt/share`
   - 进入/etc/fstab进行编辑:`share_file_name /mnt/share vboxsf default 0 0`
5. 基于LVM（逻辑分卷管理）的分区如何实现动态扩容和缩减容量？
- 创建分区并修改为LVM模式:` fdisk 分区名`
- 动态扩容: `lvextend -L {{size}}`
- 缩减容量: `lvreduce -L {{size}}`
6. 如何通过systemd设置实现在网络连通时运行一个指定脚本，在网络断开时运行另一个脚本？
- 修改systemd-networkd中的Service
- ExecStartPost=网络连通时运行的指定脚本
- ExecStopPost=网络断开时运行的另一个脚本
7. 如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动，实现杀不死？
-   ```linux
    sudo systemctl vi scriptname
    restart = always
    sudo systemctl daemon-reload
    ```
## 实验问题
1. 部分命令如系统管理的关机、重启等无法录制
2. 部分软件不存在，使用`sudo apt install`进行安装
3. 部分进程安装软件后仍不存在（如httpd），使用其他进程代替。
## 参考资料
- [阮一峰的网络日志 Systemd 入门教程：命令篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html)
- [阮一峰的网络日志 Systemd 入门教程：实战篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html)
- [第三章：Linux服务器系统管理基础 课件](https://c4pr1c3.github.io/LinuxSysAdmin/chap0x03.md.html#/lvm-arch)
- [Linux 系统与网络管理(2021)教学视频](https://www.bilibili.com/video/BV1Hb4y1R7FE?p=60)